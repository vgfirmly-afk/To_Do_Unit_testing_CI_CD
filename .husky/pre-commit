echo "Running pre-commit checks..."
npm run format

# # # Lint the codebase to ensure code quality
echo "Linting the codebase..."
npm run lint

# # Install dependencies in CI mode to ensure a clean state
# npm ci --prefer-offline --no-audit --no-fund

# # # Run the test-percentage check script. If it exits non-zero, push is blocked.
# # node scripts/check-tests-percentage.js || {
# #   echo "Pre-push check failed: test pass percentage below required threshold."
# #   exit 1
# # }

echo "Running tests..."
# npm test

# node scripts/check-tests-percentage.js || {
#   echo "Pre-push check failed: test pass percentage below required threshold."
#   exit 1
# }

#!/bin/sh


echo "Running coverage check..."
if ! npm run coverage:check 2>&1 | tee /dev/tty; then
  echo "❌ Coverage below required thresholds — commit blocked"
  exit 1
fi
echo "✅ Coverage OK"


echo "Checking for unused files/dependencies..."
# npm run knip

# Run knip LAST because it is the slowest and most likely to fail
# npm run knip || {
#   echo "Knip check failed: unused files/exports/deps detected."
#   exit 1
# }